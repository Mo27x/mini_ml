(* Fizzbuzz program to showcase the weak typer (typer_naive)
    uses: Func, ifThenElse, Concat, Print, ...
 *)

let is_mod3 = fun n -> (=) ((mod) n 3) 0
let is_mod5 = fun n -> (=) ((mod) n 5) 0

let fizzbuzz = fun n ->
    let result = (^)
        (if (is_mod3 n) then "fizz" else "")
        (if (is_mod5 n) then "buzz" else "")
    in if ((<>) result "") then result else "boring"
    
let main = 
    let n = 10 in
    print n;
    print (^) " : " fizzbuzz n